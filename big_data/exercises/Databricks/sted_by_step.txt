from pyspark.sql.functions import regexp_replace, when

# Limpiar la columna "duration" eliminando caracteres no numéricos y convirtiendo valores nulos a 0
# Usaremos la expresión regular [^0-9] para indicar que todo lo que no sean números, sea reemplazado por ""
# La función when nos permite expresar que siempre que el valor sea = "", se lleve un 0, y en cualquier otro caso, se deje el mismo valor de la columna
# Finalmente usamos la función cast para convertir a Integer el DateType de la columna duration 
df = df.withColumn("duration", regexp_replace("duration", "[^0-9]", ""))
df = df.withColumn("duration", when(df["duration"].isNull() , 0).otherwise(df["duration"]).cast("int"))

display(df)
